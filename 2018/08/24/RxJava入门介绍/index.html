
 <!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
    <title>Michael的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Michael">
    

    
    <meta name="description" content="RxJava���Ž������ʲô��RxJava��һ���ʣ��첽��  RxJava �� GitHub ��ҳ�ϵ����ҽ�����”A library for composing asynchronous and event-based programs using observable sequences for the Java VM”(һ���� Java VM ��ʹ�ÿɹ">
<meta property="og:type" content="article">
<meta property="og:title" content="Michael的博客">
<meta property="og:url" content="http://yoursite.com/2018/08/24/RxJava入门介绍/index.html">
<meta property="og:site_name" content="Michael的博客">
<meta property="og:description" content="RxJava���Ž������ʲô��RxJava��һ���ʣ��첽��  RxJava �� GitHub ��ҳ�ϵ����ҽ�����”A library for composing asynchronous and event-based programs using observable sequences for the Java VM”(һ���� Java VM ��ʹ�ÿɹ">
<meta property="og:locale" content="en">
<meta property="og:image" content="e:/���Ͽ�/��������/��ʼ�¼/�ӻ���/observer-pattern.jpg">
<meta property="og:image" content="e:/���Ͽ�/��������/��ʼ�¼/�ӻ���/RxJava-observer-pattern.jpg">
<meta property="og:image" content="e:/���Ͽ�/��������/��ʼ�¼/�ӻ���/subscribe-on.jpg">
<meta property="og:image" content="e:/���Ͽ�/��������/��ʼ�¼/�ӻ���/observe-on.jpg">
<meta property="og:image" content="e:/���Ͽ�/��������/��ʼ�¼/�ӻ���/complex-scheduler.jpg">
<meta property="og:updated_time" content="2017-10-16T03:27:55.285Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Michael的博客">
<meta name="twitter:description" content="RxJava���Ž������ʲô��RxJava��һ���ʣ��첽��  RxJava �� GitHub ��ҳ�ϵ����ҽ�����”A library for composing asynchronous and event-based programs using observable sequences for the Java VM”(һ���� Java VM ��ʹ�ÿɹ">
<meta name="twitter:image" content="e:/���Ͽ�/��������/��ʼ�¼/�ӻ���/observer-pattern.jpg">

    
    <link rel="alternative" href="/atom.xml" title="Michael的博客" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Michael的博客" title="Michael的博客"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Michael的博客">Michael的博客</a></h1>
				<h2 class="blog-motto">落霞与孤鹜起飞，秋水共长天一色。</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/08/24/RxJava入门介绍/" title="" itemprop="url"></a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Michael" target="_blank" itemprop="author">Michael</a>
		
  <p class="article-time">
    <time datetime="2018-08-24T01:32:17.674Z" itemprop="datePublished"> Published 2018-08-24</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">Contents</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RxJava���Z���"><span class="toc-number">1.</span> <span class="toc-text">RxJava���Ž���</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#���"><span class="toc-number">1.1.</span> <span class="toc-text">���</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API-���ܺ�ԭ�����"><span class="toc-number">1.2.</span> <span class="toc-text">API ���ܺ�ԭ�����</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-�����չ�L۲���gʽ"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.  �����չ�Ĺ۲���ģʽ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-����ʵ��"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. ����ʵ��</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-����-Observer"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">2.1 ���� Observer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-����-Observable"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.2 ���� Observable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-Subscribe-����"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">2.3 Subscribe (����)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-ʹ��ʾ��"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">2.4 ʹ��ʾ��</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-�߳̿���-Scheduler"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. �߳̿���(Scheduler)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-Scheduler-��-API"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">3.1 Scheduler �� API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-Scheduler��ԭ��"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">3.2 Scheduler��ԭ��</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-�任"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.�任</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-API"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">4.1 API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-�任��ԭ��-lift"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">4.2 �任��ԭ��(lift)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-compose-��-Observable-����i任"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">4.3 compose: �� Observable ����ı任</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-�߳̿��oi�Scheduler"><span class="toc-number">1.2.5.</span> <span class="toc-text">5. �߳̿��ƣ�Scheduler</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-Scheduler��API"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">5.1 Scheduler��API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-Scheduler��ԭ��"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">5.2 Scheduler��ԭ��</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-���죺doOnSubscribe"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">5.3 ���죺doOnSubscribe()</span></a></li></ol></li></ol></li></ol></li></ol>
		
		</div>
		
		<script src="\assets\js\APlayer.min.js"> </script><h1 id="RxJava���Z���"><a href="#RxJava���Z���" class="headerlink" title="RxJava���Ž���"></a>RxJava���Ž���</h1><h2 id="���"><a href="#���" class="headerlink" title="���"></a>���</h2><p>ʲô��RxJava��һ���ʣ��첽��</p>
<blockquote>
<p>RxJava �� GitHub ��ҳ�ϵ����ҽ�����”A library for composing asynchronous and event-based programs using observable sequences for the Java VM”(һ���� Java VM ��ʹ�ÿɹ۲������������첽�ġ������¼��ĳ���Ŀ�)������� RxJava��</p>
</blockquote>
<p>RxJava���ŵ㣺һ���ʣ���ࡣ</p>
<p>�첽�����ܹؼ���һ���ǳ���ļ���ԣ���Ϊ�ڵ��ȹ��̱Ƚϸ��ӵ�����£��첽���뾭�������дҲ�ѱ�������Android�����AsyncTask��Handler����ʵ����Ϊ�����첽������Ӽ�ࡣRxJava ������Ҳ�Ǽ�࣬�����ļ������ڲ�֮ͬ�����ڣ����ų����߼����Խ��Խ���ӣ�����Ȼ�ܹ����ּ�ࡣ</p>
<p>һ�����ӣ�<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Thread() &#123; </span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        <span class="keyword">super</span>.run(); </span><br><span class="line">        <span class="keyword">for</span> (File folder : folders) &#123; </span><br><span class="line">            File[] files = folder.listFiles(); </span><br><span class="line">            <span class="keyword">for</span> (File file : files) &#123; </span><br><span class="line">                <span class="keyword">if</span> (file.getName().endsWith(<span class="string">".png"</span>)) &#123; </span><br><span class="line">                    <span class="keyword">final</span> Bitmap bitmap = getBitmapFromFile(file); </span><br><span class="line">                    getActivity().runOnUiThread(<span class="keyword">new</span> Runnable() &#123; </span><br><span class="line">                        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123; </span><br><span class="line">                            imageCollectorView.addImage(bitmap); </span><br><span class="line">                        &#125; </span><br><span class="line">                    &#125;); </span><br><span class="line">                    &#125; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;.start();</span><br></pre></td></tr></table></figure></p>
<p>�����ʹ�� RxJava ��ʵ�ַ�ʽ�������ģ�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Observable.from(folders)</span><br><span class="line">    .flatMap(<span class="keyword">new</span> Func1&lt;File, Observable&lt;File&gt;&gt;() &#123; </span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> Observable&lt;File&gt; <span class="title">call</span><span class="params">(File file)</span> </span>&#123; </span><br><span class="line">            <span class="keyword">return</span> Observable.from(file.listFiles()); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;) </span><br><span class="line">    .filter(<span class="keyword">new</span> Func1&lt;File, Boolean&gt;() &#123; </span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> Boolean <span class="title">call</span><span class="params">(File file)</span> </span>&#123; </span><br><span class="line">            <span class="keyword">return</span> file.getName().endsWith(<span class="string">".png"</span>); &#125; &#125;</span><br><span class="line">    ) </span><br><span class="line">    .map(<span class="keyword">new</span> Func1&lt;File, Bitmap&gt;() &#123; </span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> Bitmap <span class="title">call</span><span class="params">(File file)</span> </span>&#123; </span><br><span class="line">            <span class="keyword">return</span> getBitmapFromFile(file); &#125; &#125;</span><br><span class="line">        ) </span><br><span class="line">    .subscribeOn(Schedulers.io()) </span><br><span class="line">    .observeOn(AndroidSchedulers.mainThread()) </span><br><span class="line">    .subscribe(<span class="keyword">new</span> Action1&lt;Bitmap&gt;() &#123; </span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Bitmap bitmap)</span> </span>&#123; </span><br><span class="line">            imageCollectorView.addImage(bitmap); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>RxJava �����ʵ�֣���һ�����ϵ��µ���ʽ���ã�û���κ�Ƕ�ף������߼��ļ�������Ǿ������Ƶģ��������ø���ʱ���������ƽ��������ԡ�</p>
<p>���⣬������IDE��AndroidStudio ����ʵÿ�δ�ĳ��Java�ļ���ʱ����ῴ�����Զ�Lambda����Ԥ�����⽫������������ؿ��������߼���</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Observable.from(folders) </span><br><span class="line">    .flatMap((Func1) (folder) -&gt; &#123; Observable.from(file.listFiles()) &#125;) </span><br><span class="line">    .filter((Func1) (file) -&gt; &#123; file.getName().endsWith(<span class="string">".png"</span>) &#125;) </span><br><span class="line">    .map((Func1) (file) -&gt; &#123; getBitmapFromFile(file) &#125;) </span><br><span class="line">    .subscribeOn(Schedulers.io()) </span><br><span class="line">    .observeOn(AndroidSchedulers.mainThread()) </span><br><span class="line">    .subscribe((Action1) (bitmap) -&gt; &#123;imageCollectorView.addImage(bitmap) &#125;);</span><br></pre></td></tr></table></figure>
<p>���ԣ� RxJava �����ģ��ͺ��ڼ�࣬�����ǰ�ʲô�����߼����ܴ���һ���ߵļ�ࡣ</p>
<h2 id="API-���ܺ�ԭ�����"><a href="#API-���ܺ�ԭ�����" class="headerlink" title="API ���ܺ�ԭ�����"></a>API ���ܺ�ԭ�����</h2><h3 id="1-�����չ�L۲���gʽ"><a href="#1-�����չ�L۲���gʽ" class="headerlink" title="1.  �����չ�Ĺ۲���ģʽ"></a>1.  �����չ�Ĺ۲���ģʽ</h3><p>RxJava ���첽ʵ�֣���ͨ��һ����չ�Ĺ۲���ģʽ��ʵ�ֵġ�</p>
<p><img src="E:\���Ͽ�\��������\��ʼ�¼\�ӻ���\observer-pattern.jpg" alt="observer-pattern"></p>
<p>�� RxJava ��Ϊһ�����߿⣬ʹ�õľ���ͨ����ʽ�Ĺ۲���ģʽ��</p>
<p>RxJava�Ĺ۲���ģʽ��</p>
<p>RxJava ���ĸ��������Observable(�ɹ۲��ߣ������۲���)�� Observer(�۲���)�� subscribe(����)���¼�Observable��Observerͨ�� subscribe()����ʵ�ֶ��Ĺ�ϵ���Ӷ� Observable��������Ҫ��ʱ�򷢳��¼���֪ͨ Observer���봫ͳ�۲���ģʽ��ͬ�� RxJava ���¼��ص�����������ͨ�¼� onNext()���൱�� onClick() / onEvent()��֮�⣬������������������¼���onCompleted()�� onError()��</p>
<ul>
<li>onCompleted(): �¼�������ᡣRxJava ������ÿ���¼�����������������ǿ���һ�����С�RxJava �涨�������������µ�onNext()����ʱ����Ҫ���� onCompleted()������Ϊ��־��</li>
<li>onError(): �¼������쳣�����¼���������г��쳣ʱ��onError()�ᱻ������ͬʱ�����Զ���ֹ�������������¼�������</li>
<li>��һ����ȷ���е��¼�������, onCompleted()�� onError()����ֻ��һ�����������¼������е����һ������Ҫע����ǣ�onCompleted()�� onError()����Ҳ�ǻ���ģ����ڶ����е���������һ�����Ͳ�Ӧ���ٵ�����һ����</li>
</ul>
<p>RxJava �Ĺ۲���ģʽ��������ͼ��</p>
<p><img src="E:\���Ͽ�\��������\��ʼ�¼\�ӻ���\RxJava-observer-pattern.jpg" alt="RxJava-observer-pattern"></p>
<h3 id="2-����ʵ��"><a href="#2-����ʵ��" class="headerlink" title="2. ����ʵ��"></a>2. ����ʵ��</h3><p>�������ϵĸ�� RxJava �Ļ���ʵ����Ҫ�����㣺</p>
<h4 id="2-1-����-Observer"><a href="#2-1-����-Observer" class="headerlink" title="2.1 ���� Observer"></a>2.1 ���� Observer</h4><p>Observer ���۲��ߣ��������¼�������ʱ������������Ϊ�� RxJava �е� Observer�ӿڵ�ʵ�ַ�ʽ��</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Observer&lt;String&gt; observer = <span class="keyword">new</span> Observer&lt;String&gt;() &#123; </span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String s)</span> </span>&#123; </span><br><span class="line">            Log.d(tag, <span class="string">"Item: "</span> + s); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123; </span><br><span class="line">            Log.d(tag, <span class="string">"Completed!"</span>); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123; </span><br><span class="line">            Log.d(tag, <span class="string">"Error!"</span>); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>
<p>���� Observer�ӿ�֮�⣬RxJava ��������һ��ʵ���� Observer�ĳ����ࣺSubscriber��Subscriber�� Observer�ӿڽ�����һЩ��չ�������ǵĻ���ʹ�÷�ʽ����ȫһ���ģ�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Subscriber&lt;String&gt; subscriber = <span class="keyword">new</span> Subscriber&lt;String&gt;() &#123; </span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String s)</span> </span>&#123; </span><br><span class="line">        Log.d(tag, <span class="string">"Item: "</span> + s); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        Log.d(tag, <span class="string">"Completed!"</span>); </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123; </span><br><span class="line">        Log.d(tag, <span class="string">"Error!"</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>��������ʹ�÷�ʽһ����ʵ���ϣ��� RxJava �� subscribe �����У�ObserverҲ���ǻ��ȱ�ת����һ�� Subscriber��ʹ�á����������ֻ��ʹ�û������ܣ�ѡ�� Observer �� Subscriber����ȫһ���ġ����ǵ��������ʹ������˵��Ҫ�����㣺</p>
<ul>
<li>onStart()������ Subscriber���ӵķ����������� subscribe �տ�ʼ�����¼���δ����֮ǰ�����ã�����������һЩ׼���������������ݵ���������á�����һ����ѡ������Ĭ�����������ʵ��Ϊ�ա���Ҫע����ǣ������׼���������߳���Ҫ�����絯��һ����ʾ���ȵĶԻ�������������߳�ִ�У��� onStart() �Ͳ������ˣ���Ϊ�������� subscribe ���������̱߳����ã�������ָ���̡߳�Ҫ��ָ�����߳�����׼������������ʹ�� doOnSubscribe() ��������������ں�������п�����</li>
<li>unsubscribe()�� ���� Subscriber��ʵ�ֵ���һ���ӿ� Subscription�ķ���������ȡ�����ġ���������������ú�Subscriber�����ٽ����¼���һ���������������ǰ������ʹ�� isUnsubscribed()���ж�һ��״̬�� unsubscribe()�����������Ҫ����Ϊ��subscribe()֮�� Observable����� Subscriber�����ã��������������ܼ�ʱ���ͷţ������ڴ�й¶�ķ��ա�������ñ���һ��ԭ��Ҫ�ڲ���ʹ�õ�ʱ�򾡿��ں��ʵĵط������� onPause() onStop()�ȷ����У����� unsubscribe()��������ù�ϵ���Ա����ڴ�й¶�ķ�����</li>
</ul>
<h4 id="2-2-����-Observable"><a href="#2-2-����-Observable" class="headerlink" title="2.2 ���� Observable"></a>2.2 ���� Observable</h4><p>Observable �����۲��ߣ�������ʲôʱ�򴥷��¼��Լ������������¼��� RxJava ʹ�� create()����������һ�� Observable ����Ϊ�������¼���������</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Observable observable = Observable.create(<span class="keyword">new</span> Observable.OnSubscribe&lt;String&gt;() &#123; </span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> String&gt; subscriber)</span> </span>&#123; </span><br><span class="line">        subscriber.onNext(<span class="string">"Hello"</span>); </span><br><span class="line">        subscriber.onNext(<span class="string">"Rx"</span>); </span><br><span class="line">        subscriber.onNext(<span class="string">"Java"</span>); </span><br><span class="line">        subscriber.onCompleted(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>���Կ��������ﴫ����һ�� OnSubscribe������Ϊ������OnSubscribe�ᱻ�洢�ڷ��ص� Observable�����У����������൱��һ���ƻ����� Observable�����ĵ�ʱ��OnSubscribe�� call()�������Զ������ã��¼����оͻ������趨���δ�������������Ĵ��룬���ǹ۲���Subscriber���ᱻ�������� onNext()��һ�� onCompleted()�����������ɱ��۲��ߵ����˹۲��ߵĻص���������ʵ�����ɱ��۲�����۲��ߵ��¼����ݣ����۲���ģʽ��</p>
<p>create()������ RxJava ������Ĵ����¼����еķ������������������ RxJava ���ṩ��һЩ����������ݴ����¼����У����磺</p>
<ul>
<li><p>just(T…): ������Ĳ������η��ͳ�����</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Observable observable = Observable.just(<span class="string">"Hello"</span>, <span class="string">"Hi"</span>, <span class="string">"RxJava"</span>);</span><br><span class="line"><span class="comment">// �������ε��ã�</span></span><br><span class="line"><span class="comment">// onNext("Hello");</span></span><br><span class="line"><span class="comment">// onNext("Hi");</span></span><br><span class="line"><span class="comment">// onNext("RxJava");</span></span><br><span class="line"><span class="comment">// onCompleted();</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>from(T[])/ from(Iterable&lt;? extends T&gt;) : ������������ Iterable��ֳɾ����������η��ͳ�����</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String[] words = &#123;<span class="string">"Hello"</span>, <span class="string">"Hi"</span>, <span class="string">"RxJava"</span>&#125;;</span><br><span class="line">Observable observable = Observable.from(words);</span><br><span class="line"><span class="comment">// �������ε��ã�</span></span><br><span class="line"><span class="comment">// onNext("Hello");</span></span><br><span class="line"><span class="comment">// onNext("Hi");</span></span><br><span class="line"><span class="comment">// onNext("RxJava");</span></span><br><span class="line"><span class="comment">// onCompleted();</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>���� just(T…)�����Ӻ� from(T[])�����ӣ�����֮ǰ�� create(OnSubscribe)�������ǵȼ۵ġ�</p>
<h4 id="2-3-Subscribe-����"><a href="#2-3-Subscribe-����" class="headerlink" title="2.3 Subscribe (����)"></a>2.3 Subscribe (����)</h4><p>������ Observable�� Observer֮������ subscribe()���������������������������ӾͿ��Թ����ˡ�������ʽ�ܼ򵥣�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">observable.subscribe(observer);</span><br><span class="line"><span class="comment">// ���ߣ�</span></span><br><span class="line">observable.subscribe(subscriber);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>���˿��ܻ�ע�⵽��subscribe()��������е�֣����������ǡ�observalbe������ observer/ subscriber�������ǡ�observer /subscriber������ observalbe����<br>�⿴����������־�����˶��ߡ�һ���ߵ��˶����ϵ�������˶������е��Ť����������� API ��Ƴ�observer.subscribe(observable)/ subscriber.subscribe(observable)<br>����Ȼ���ӷ���˼ά�߼���������ʽ API ����ƾ����Ӱ���ˣ��Ƚ����������ǵò���ʧ�ġ�</p>
</blockquote>
<p>Observable.subscribe(Subscriber)���ڲ�ʵ���������ģ������Ĵ��룩:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Subscription <span class="title">subscribe</span><span class="params">(Subscriber subscriber)</span> </span>&#123; </span><br><span class="line">    subscriber.onStart(); </span><br><span class="line">    onSubscribe.call(subscriber); </span><br><span class="line">    <span class="keyword">return</span> subscriber;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>���Կ�����subscriber()����3���£�</p>
<ol>
<li>���� Subscriber.onStart() �����������ǰ���Ѿ����ܹ�����һ����ѡ��׼��������</li>
<li>���� Observable�е� OnSubscribe.call(Subscriber)��������¼����͵��߼���ʼ���С�����Ҳ���Կ������� RxJava �У�Observable�������ڴ�����ʱ���������ʼ�����¼����������������ĵ�ʱ�򣬼��� subscribe()����ִ�е�ʱ��</li>
<li>������� Subscriber��Ϊ Subscription���ء�����Ϊ�˷��� unsubscribe()��</li>
</ol>
<p>���� subscribe(Observer)�� subscribe(Subscriber)��subscribe()��֧�ֲ���������Ļص���RxJava ���Զ����ݶ��崴����Subscriber����ʽ���£�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Action1&lt;String&gt; onNextAction = <span class="keyword">new</span> Action1&lt;String&gt;() &#123; </span><br><span class="line">    <span class="comment">// onNext() </span></span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(String s)</span> </span>&#123; </span><br><span class="line">        Log.d(tag, s); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Action1&lt;Throwable&gt; onErrorAction = <span class="keyword">new</span> Action1&lt;Throwable&gt;() &#123; </span><br><span class="line">    <span class="comment">// onError() </span></span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Throwable throwable)</span> </span>&#123; </span><br><span class="line">        <span class="comment">// Error handling </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Action0 onCompletedAction = <span class="keyword">new</span> Action0() &#123; </span><br><span class="line">    <span class="comment">// onCompleted() </span></span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        Log.d(tag, <span class="string">"completed"</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// �Զ����� Subscriber ����ʹ�� onNextAction ������ onNext()</span></span><br><span class="line">observable.subscribe(onNextAction);</span><br><span class="line"><span class="comment">// �Զ����� Subscriber ����ʹ�� onNextAction �� onErrorAction ������ onNext() �� onError()</span></span><br><span class="line">observable.subscribe(onNextAction, onErrorAction);</span><br><span class="line"><span class="comment">// �Զ����� Subscriber ����ʹ�� onNextAction�� onErrorAction �� onCompletedAction ������ onNext()�� onError() �� onCompleted()</span></span><br><span class="line">observable.subscribe(onNextAction, onErrorAction, onCompletedAction);</span><br></pre></td></tr></table></figure>
<p>Action0�� RxJava ��һ���ӿڣ���ֻ��һ������ call()������������޲��޷���ֵ�ģ����� onCompleted()����Ҳ���޲��޷���ֵ�ģ���� Action0���Ա�����һ����װ���󣬽� onCompleted()�����ݴ���������Լ���Ϊһ���������� subscribe()��ʵ�ֲ���������Ļص���������ʵҲ���Կ����� onCompleted()������Ϊ����������subscribe()���൱������ĳЩ�����еġ��հ����� Action1Ҳ��һ���ӿڣ���ͬ��ֻ��һ������ call(T param)���������Ҳ�޷���ֵ������һ���������� Action0ͬ������ onNext(T obj)�� onError(Throwable error)Ҳ�ǵ������޷���ֵ�ģ���� Action1���Խ�onNext(obj)�� onError(error)����������� subscribe()��ʵ�ֲ���������Ļص�����ʵ�ϣ���Ȼ Action0�� Action1�� API ��ʹ����㷺���� RxJava ���ṩ�˶�� ActionX��ʽ�Ľӿ� (���� Action2, Action3) �ģ����ǿ��Ա����԰�װ��ͬ���޷���ֵ�ķ�����</p>
<h4 id="2-4-ʹ��ʾ��"><a href="#2-4-ʹ��ʾ��" class="headerlink" title="2.4 ʹ��ʾ��"></a>2.4 ʹ��ʾ��</h4><p>a. ��ӡ�ַ�������</p>
<p>���ַ������� names�е������ַ������δ�ӡ������</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String[] names = ...;</span><br><span class="line">Observable.from(names) </span><br><span class="line">  .subscribe(<span class="keyword">new</span> Action1&lt;String&gt;() &#123; </span><br><span class="line">      <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(String name)</span> </span>&#123; </span><br><span class="line">          Log.d(tag, name); </span><br><span class="line">      &#125; </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>b. �� id ȡ��ͼƬ����ʾ</p>
<p>��ָ����һ�� drawable �ļ� id drawableResȡ��ͼƬ������ʾ�� ImageView�У����ڳ����쳣��ʱ���ӡ Toast ����</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> drawableRes = ...;</span><br><span class="line">ImageView imageView = ...;</span><br><span class="line">Observable.create(<span class="keyword">new</span> OnSubscribe&lt;Drawable&gt;() &#123; </span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> Drawable&gt; subscriber)</span> </span>&#123; </span><br><span class="line">        Drawable drawable = getTheme().getDrawable(drawableRes)); </span><br><span class="line">        subscriber.onNext(drawable); subscriber.onCompleted(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;).subscribe(<span class="keyword">new</span> Observer&lt;Drawable&gt;() &#123; </span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Drawable drawable)</span> </span>&#123; </span><br><span class="line">        imageView.setImageDrawable(drawable); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="meta">@Override</span> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123; </span><br><span class="line"></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123; </span><br><span class="line">        Toast.makeText(activity, <span class="string">"Error!"</span>, Toast.LENGTH_SHORT).show(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>���������������������������� Observable�� Subscriber������ subscribe()�����Ǵ�������һ�� RxJava �Ļ���ʹ�þ�����ˡ�Ȼ������ RxJava ��Ĭ�Ϲ����У��¼��ķ��������Ѷ�����ͬһ���̵߳ġ�Ҳ����˵�����ֻ������ķ�����ʵ�ֳ�����ֻ��һ��ͬ���Ĺ۲���ģʽ���۲���ģʽ�����Ŀ�ľ��ǡ���̨����ǰ̨�ص������첽���ƣ�����첽���� RxJava ��������Ҫ�ġ���Ҫʵ���첽������Ҫ�õ� RxJava ����һ�����Scheduler��</p>
<h3 id="3-�߳̿���-Scheduler"><a href="#3-�߳̿���-Scheduler" class="headerlink" title="3. �߳̿���(Scheduler)"></a>3. �߳̿���(Scheduler)</h3><p>�ڲ�ָ���̵߳�����£� RxJava ��ѭ�����̲߳����ԭ�򣬼������ĸ��̵߳��� subscribe()�������ĸ��߳������¼������ĸ��߳������¼��������ĸ��߳������¼��������Ҫ�л��̣߳�����Ҫ�õ� Scheduler������������</p>
<h4 id="3-1-Scheduler-��-API"><a href="#3-1-Scheduler-��-API" class="headerlink" title="3.1 Scheduler �� API"></a>3.1 Scheduler �� API</h4><p>��RxJava �У�Scheduler �������������൱���߳̿�������RxJava ͨ������ָ��ÿһ�δ���Ӧ��������ʲô�����̡߳�RxJava �Ѿ������˼��� Scheduler �������Ѿ��ʺϴ������ʹ�ó�����</p>
<ul>
<li>Schedulers.immediate(): ֱ���ڵ�ǰ�߳����У��൱�ڲ�ָ���̡߳�����Ĭ�ϵ� Scheduler��</li>
<li>Schedulers.newThread(): �����������̣߳��������߳�ִ�в�����</li>
<li>Schedulers.io(): I/O ��������д�ļ�����д���ݿ⡢������Ϣ�����ȣ���ʹ�õ� Scheduler����Ϊģʽ�� newThread() ��࣬�������� io() ���ڲ�ʵ��������һ�����������޵��̳߳أ��������ÿ��е��̣߳���˶�������� io() �� newThread() ����Ч�ʡ���Ҫ�Ѽ��㹤������ io() �У����Ա��ⴴ������Ҫ���̡߳���</li>
<li>Schedulers.computation(): ������ʹ�õ� Scheduler���������ָ���� CPU �ܼ��ͼ��㣬�����ᱻ I/O �Ȳ����������ܵĲ���������ͼ�εļ��㡣��� Scheduler ʹ�õĹ̶����̳߳أ���СΪ CPU ��������Ҫ�� I/O �������� computation() �У����� I/O �����ĵȴ�ʱ����˷� CPU��</li>
<li>���⣬ Android ����һ��ר�õ� AndroidSchedulers.mainThread()����ָ���Ĳ������� Android ���߳����С�</li>
</ul>
<p>�����⼸�� Scheduler ���Ϳ���ʹ�� subscribeOn() �� observeOn() �������������߳̽��п����ˡ� <em> subscribeOn(): ָ�� subscribe() ���������̣߳��� Observable.OnSubscribe ������ʱ�������̡߳����߽����¼��������̡߳� </em> observeOn(): ָ�� Subscriber �������ڵ��̡߳����߽����¼����ѵ��̡߳�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">    .subscribeOn(Schedulers.io()) <span class="comment">// ָ�� subscribe() ������ IO �߳�</span></span><br><span class="line">    .observeOn(AndroidSchedulers.mainThread()) <span class="comment">// ָ�� Subscriber �Ļص����������߳�</span></span><br><span class="line">    .subscribe(<span class="keyword">new</span> Action1&lt;Integer&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Integer number)</span> </span>&#123;</span><br><span class="line">            Log.d(tag, <span class="string">"number:"</span> + number);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>������δ����У����� subscribeOn(Schedulers.io()) ��ָ�������������¼������� 1��2��3��4 ������ IO �̷߳����������� observeOn(AndroidScheculers.mainThread()) ��ָ������� subscriber ���ֵĴ�ӡ�����������߳� ����ʵ�ϣ������� subscribe() ֮ǰд������ subscribeOn(Scheduler.io()) �� observeOn(AndroidSchedulers.mainThread()) ��ʹ�÷�ʽ�ǳ��������������ڶ����� ����̨�߳�ȡ���ݣ����߳���ʾ���ĳ�����ԡ�</p>
<p>��ǰ���ᵽ����ͼƬ id ȡ��ͼƬ����ʾ�����ӣ����Ҳ���������䣺</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> drawableRes = ...;</span><br><span class="line">ImageView imageView = ...;</span><br><span class="line">Observable.create(<span class="keyword">new</span> OnSubscribe&lt;Drawable&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber&lt;? <span class="keyword">super</span> Drawable&gt; subscriber)</span> </span>&#123;</span><br><span class="line">        Drawable drawable = getTheme().getDrawable(drawableRes));</span><br><span class="line">        subscriber.onNext(drawable);</span><br><span class="line">        subscriber.onCompleted();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">.subscribeOn(Schedulers.io()) <span class="comment">// ָ�� subscribe() ������ IO �߳�</span></span><br><span class="line">.observeOn(AndroidSchedulers.mainThread()) <span class="comment">// ָ�� Subscriber �Ļص����������߳�</span></span><br><span class="line">.subscribe(<span class="keyword">new</span> Observer&lt;Drawable&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Drawable drawable)</span> </span>&#123;</span><br><span class="line">        imageView.setImageDrawable(drawable);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">        Toast.makeText(activity, <span class="string">"Error!"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>��ô������ͼƬ���ᷢ���� IO �̣߳�������ͼƬ���趨�������̡߳������ζ�ţ���ʹ����ͼƬ�ķ��˼�ʮ�������ٺ����ʱ�䣬Ҳ�������˿������Ŀ��١�</p>
<h4 id="3-2-Scheduler��ԭ��"><a href="#3-2-Scheduler��ԭ��" class="headerlink" title="3.2 Scheduler��ԭ��"></a>3.2 Scheduler��ԭ��</h4><p>RxJava �� Scheduler API �ܷ��㣬Ҳ�����棨����һ�仰�Ͱ��߳��л��ˣ���ô�����ģ����� subscribe() ���������ֱ�ӵ��õķ���������ȻҲ�ܱ�ָ���̣߳�����Ȼ�� Scheduler ��ԭ����Ҫ���ں��潲����Ϊ����ԭ��������һ�ڡ��任����ԭ����Ϊ�����ġ�</p>
<h3 id="4-�任"><a href="#4-�任" class="headerlink" title="4.�任"></a>4.�任</h3><p>RxJava �ṩ�˶��¼����н��б任��֧�֣��������ĺ��Ĺ���֮һ��Ҳ�Ǵ������˵��RxJava ����̫�����ˡ������ԭ����ν�任�����ǽ��¼������еĶ�����������н��мӹ�����ת���ɲ�ͬ���¼����¼����С�</p>
<h4 id="4-1-API"><a href="#4-1-API" class="headerlink" title="4.1 API"></a>4.1 API</h4><p>���ȿ�һ�� map() �����ӣ�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(<span class="string">"images/logo.png"</span>) <span class="comment">// �������� String</span></span><br><span class="line">    .map(<span class="keyword">new</span> Func1&lt;String, Bitmap&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Bitmap <span class="title">call</span><span class="params">(String filePath)</span> </span>&#123; <span class="comment">// �������� String</span></span><br><span class="line">            <span class="keyword">return</span> getBitmapFromPath(filePath); <span class="comment">// �������� Bitmap</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .subscribe(<span class="keyword">new</span> Action1&lt;Bitmap&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Bitmap bitmap)</span> </span>&#123; <span class="comment">// �������� Bitmap</span></span><br><span class="line">            showBitmap(bitmap);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>
<p>���������һ������ Func1 ���ࡣ���� Action1 �ǳ����ƣ�Ҳ�� RxJava ��һ���ӿڣ����ڰ�װ����һ�������ķ����� Func1 �� Action ���������ڣ� Func1 ��װ�����з���ֵ�ķ��������⣬�� ActionX һ���� FuncX Ҳ�ж�������ڲ�ͬ���������ķ�����FuncX �� ActionX �������� FuncX ��װ�����з���ֵ�ķ�����</p>
<p>���Կ�����map() �����������е� String ����ת����һ�� Bitmap ����󷵻أ����ھ��� map() �������¼��Ĳ�������Ҳ�� String תΪ�� Bitmap������ֱ�ӱ任���󲢷��صģ��������Ҳ���������ı任������ RxJava �ı任Զ��ֹ��������������������¼����󣬻�������������¼����У���ʹ�� RxJava ��÷ǳ���</p>
<ul>
<li>map(): �¼������ֱ�ӱ任�����幦�������Ѿ����ܹ������� RxJava ��õı任��</li>
<li>flatMap(): ����һ�������õ��ǳ������ı任������Ҿ�������Щƪ������������ ���ȼ�����ôһ�����󣺼�����һ�����ݽṹ��ѧ������������Ҫ��ӡ��һ��ѧ�������֡�ʵ�ַ�ʽ�ܼ򵥣�<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Student[] students = ...;</span><br><span class="line">Subscriber&lt;String&gt; subscriber = <span class="keyword">new</span> Subscriber&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        Log.d(tag, name);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line">Observable.from(students)</span><br><span class="line">    .map(<span class="keyword">new</span> Func1&lt;Student, String&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">call</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> student.getName();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .subscribe(subscriber);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>�ܼ򵥡���ô�ټ��裺���Ҫ��ӡ��ÿ��ѧ������Ҫ�޵����пγ̵������أ���������������ڣ�ÿ��ѧ��ֻ��һ�����֣���ȴ�ж���γ̡������ȿ�������ʵ�֣�<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Student[] students = ...;</span><br><span class="line">Subscriber&lt;Student&gt; subscriber = <span class="keyword">new</span> Subscriber&lt;Student&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">        List&lt;Course&gt; courses = student.getCourses();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; courses.size(); i++) &#123;</span><br><span class="line">            Course course = courses.get(i);</span><br><span class="line">            Log.d(tag, course.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line">Observable.from(students)</span><br><span class="line">    .subscribe(subscriber);</span><br></pre></td></tr></table></figure></p>
<p>��Ȼ�ܼ򵥡���ô����Ҳ����� Subscriber ��ʹ�� for ѭ��������ϣ�� Subscriber ��ֱ�Ӵ��뵥���� Course �����أ�����ڴ��븴�ú���Ҫ������ map() ��Ȼ�ǲ��еģ���Ϊ map() ��һ��һ��ת�����������ڵ�Ҫ����һ�Զ��ת��������ô���ܰ�һ�� Student ת���ɶ�� Course �أ�</p>
<p>���ʱ�򣬾���Ҫ�� flatMap() �ˣ�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Student[] students = ...;</span><br><span class="line">Subscriber&lt;Course&gt; subscriber = <span class="keyword">new</span> Subscriber&lt;Course&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Course course)</span> </span>&#123;</span><br><span class="line">        Log.d(tag, course.getName());</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;;</span><br><span class="line">Observable.from(students)</span><br><span class="line">    .flatMap(<span class="keyword">new</span> Func1&lt;Student, Observable&lt;Course&gt;&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Observable&lt;Course&gt; <span class="title">call</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Observable.from(student.getCourses());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .subscribe(subscriber);</span><br></pre></td></tr></table></figure>
<p>������Ĵ�����Կ����� flatMap() �� map() ��һ����ͬ�㣺��Ҳ�ǰѴ���Ĳ���ת��֮�󷵻���һ�����󡣵���Ҫע�⣬�� map() ��ͬ���ǣ� flatMap() �з��ص��Ǹ� Observable ���󣬲������ Observable ���󲢲��Ǳ�ֱ�ӷ��͵��� Subscriber �Ļص������С� flatMap() ��ԭ���������ģ�1. ʹ�ô�����¼����󴴽�һ�� Observable ����2. ����������� Observable, ���ǽ��������������ʼ�����¼���3. ÿһ������������ Observable ���͵��¼�����������ͬһ�� Observable ������� Observable ������Щ�¼�ͳһ���� Subscriber �Ļص����������������裬���¼������������ͨ��һ���´����� Observable ����ʼ�Ķ�����ƽ��֮��ͨ��ͳһ·���ַ�����ȥ�����������ƽ������ flatMap() ��ν�� flat��</p>
<h4 id="4-2-�任��ԭ��-lift"><a href="#4-2-�任��ԭ��-lift" class="headerlink" title="4.2 �任��ԭ��(lift)"></a>4.2 �任��ԭ��(lift)</h4><p>��Щ�任��Ȼ���ܸ��в�ͬ����ʵ���϶�������¼����еĴ�����ٷ��͡����� RxJava ���ڲ��������ǻ���ͬһ�������ı任������ lift(Operator)�����ȿ�һ�� lift() ���ڲ�ʵ�֣������Ĵ��룩��</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ע�⣺�ⲻ�� lift() ��Դ�룬���ǽ�Դ���������ܡ������ԡ���չ���йصĴ����޳���ĺ��Ĵ��롣</span></span><br><span class="line"><span class="comment">// �����Ҫ��Դ�룬����ȥ RxJava �� GitHub �ֿ����ء�</span></span><br><span class="line"><span class="keyword">public</span> &lt;R&gt; <span class="function">Observable&lt;R&gt; <span class="title">lift</span><span class="params">(Operator&lt;? extends R, ? <span class="keyword">super</span> T&gt; operator)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Observable.create(<span class="keyword">new</span> OnSubscribe&lt;R&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">(Subscriber subscriber)</span> </span>&#123;</span><br><span class="line">            Subscriber newSubscriber = operator.call(subscriber);</span><br><span class="line">            newSubscriber.onStart();</span><br><span class="line">            onSubscribe.call(newSubscriber);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>��δ��������˼����������һ���µ� Observable �����أ����Ҵ����� Observable ���õĲ��� OnSubscribe �Ļص����� call() �е�ʵ�־�Ȼ��������ǰ�潲���� Observable.subscribe() һ����Ȼ�����ǲ���һ��Ӵ~��һ���ĵط��ؼ������ڵڶ��� onSubscribe.call(subscriber) �е� onSubscribe ��ָ���Ķ���ͬ��</p>
<ul>
<li>subscribe() ����仰�� onSubscribe ָ���� Observable �е� onSubscribe �������û�����⣬���� lift() ֮�������͸����˵㡣</li>
<li>������ lift() ʱ��<ol>
<li>lift() ������һ�� Observable �󣬼���֮ǰ��ԭʼ Observable���Ѿ������� Observable �ˣ�</li>
<li>��ͬ���أ��� Observable ����� OnSubscribe ����֮ǰ��ԭʼ Observable �е�ԭʼ OnSubscribe��Ҳ���������� OnSubscribe��</li>
<li>���û����þ��� lift() ��� Observable �� subscribe() ��ʱ��ʹ�õ��� lift() �����ص��µ� Observable ���������������� onSubscribe.call(subscriber)��Ҳ���õ��� Observable �е��� OnSubscribe������ lift() �����ɵ��Ǹ� OnSubscribe�� </li>
<li>������� OnSubscribe �� call() �����е� onSubscribe ������ָ��ԭʼ Observable �е�ԭʼ OnSubscribe ������� call() ������� OnSubscribe ���� operator.call(subscriber) ������һ���µ� Subscriber��Operator ���������ͨ���Լ��� call() �������� Subscriber ��ԭʼ Subscriber ���й������������Լ��ġ��任��������ʵ�ֱ任����Ȼ����������� Subscriber ��ԭʼ Observable ���ж��ġ�������ʵ���� lift() ���̣��е���һ�ִ�����ƣ�ͨ���¼����غʹ���ʵ���¼����еı任��</li>
</ol>
</li>
</ul>
<p>�����ϸ�ڵĻ���Ҳ������ô˵���� Observable ִ���� lift(Operator) ����֮�󣬻᷵��һ���µ� Observable������µ� Observable ����һ������һ�����������ԭʼ�� Observable �������¼������ڴ�����͸� Subscriber��</p>
<p>��һ������� Operator ��ʵ�֡���������һ�����¼��е� Integer ����ת���� String �����ӣ������ο���</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">observable.lift(<span class="keyword">new</span> Observable.Operator&lt;String, Integer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Subscriber&lt;? <span class="keyword">super</span> Integer&gt; call(<span class="keyword">final</span> Subscriber&lt;? <span class="keyword">super</span> String&gt; subscriber) &#123;</span><br><span class="line">        <span class="comment">// ���¼������е� Integer ����ת��Ϊ String ����</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Subscriber&lt;Integer&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Integer integer)</span> </span>&#123;</span><br><span class="line">                subscriber.onNext(<span class="string">""</span> + integer);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCompleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                subscriber.onCompleted();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                subscriber.onError(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>���� lift() ��ԭ��ֻ��Ϊ��������õ��˽� RxJava ���Ӷ����Ը��õ�ʹ������Ȼ���������Ƿ������ lift() ��ԭ��RxJava �������鿪�����Զ��� Operator ��ֱ��ʹ�� lift()�����ǽ��龡��ʹ�����е� lift() ��װ�������� map() flatMap() �ȣ����������ʵ��������Ϊֱ��ʹ�� lift() �ǳ����׷���һЩ���Է��ֵĴ���</p>
</blockquote>
<h4 id="4-3-compose-��-Observable-����i任"><a href="#4-3-compose-��-Observable-����i任" class="headerlink" title="4.3 compose: �� Observable ����ı任"></a>4.3 compose: �� Observable ����ı任</h4><p>���� lift() ֮�⣬ Observable ����һ���任�������� compose(Transformer)������ lift() ���������ڣ� lift() ������¼�����¼����еģ��� compose() ����� Observable ������б任���ٸ����ӣ������ڳ������ж�� Observable ���������Ƕ���ҪӦ��һ����ͬ�� lift() �任���������ôд��</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">observable1</span><br><span class="line">    .lift1()</span><br><span class="line">    .lift2()</span><br><span class="line">    .lift3()</span><br><span class="line">    .lift4()</span><br><span class="line">    .subscribe(subscriber1);</span><br><span class="line">observable2</span><br><span class="line">    .lift1()</span><br><span class="line">    .lift2()</span><br><span class="line">    .lift3()</span><br><span class="line">    .lift4()</span><br><span class="line">    .subscribe(subscriber2);</span><br><span class="line">observable3</span><br><span class="line">    .lift1()</span><br><span class="line">    .lift2()</span><br><span class="line">    .lift3()</span><br><span class="line">    .lift4()</span><br><span class="line">    .subscribe(subscriber3);</span><br><span class="line">observable4</span><br><span class="line">    .lift1()</span><br><span class="line">    .lift2()</span><br><span class="line">    .lift3()</span><br><span class="line">    .lift4()</span><br><span class="line">    .subscribe(subscriber4);</span><br></pre></td></tr></table></figure>
<p>Ҳ���Ըĳ�������</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Observable <span class="title">liftAll</span><span class="params">(Observable observable)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> observable</span><br><span class="line">        .lift1()</span><br><span class="line">        .lift2()</span><br><span class="line">        .lift3()</span><br><span class="line">        .lift4();</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">liftAll(observable1).subscribe(subscriber1);</span><br><span class="line">liftAll(observable2).subscribe(subscriber2);</span><br><span class="line">liftAll(observable3).subscribe(subscriber3);</span><br><span class="line">liftAll(observable4).subscribe(subscriber4);</span><br></pre></td></tr></table></figure>
<p>�ɶ��ԡ���ά���Զ�����ˡ����� Observable ��һ�����������������ַ�ʽ���� Observale ��������ƺ�������������ô�����ơ���ô�죿���ʱ�򣬾�Ӧ���� compose() ������ˣ�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LiftAllTransformer</span> <span class="keyword">implements</span> <span class="title">Observable</span>.<span class="title">Transformer</span>&lt;<span class="title">Integer</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Observable&lt;String&gt; <span class="title">call</span><span class="params">(Observable&lt;Integer&gt; observable)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> observable</span><br><span class="line">            .lift1()</span><br><span class="line">            .lift2()</span><br><span class="line">            .lift3()</span><br><span class="line">            .lift4();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line">Transformer liftAll = <span class="keyword">new</span> LiftAllTransformer();</span><br><span class="line">observable1.compose(liftAll).subscribe(subscriber1);</span><br><span class="line">observable2.compose(liftAll).subscribe(subscriber2);</span><br><span class="line">observable3.compose(liftAll).subscribe(subscriber3);</span><br><span class="line">observable4.compose(liftAll).subscribe(subscriber4);</span><br></pre></td></tr></table></figure>
<p>������������ʹ�� compose() ������Observable �������ô���� Transformer ����� call ����ֱ�Ӷ�������д���Ҳ�Ͳ��ر����ڷ����������ˡ�</p>
<h3 id="5-�߳̿��oi�Scheduler"><a href="#5-�߳̿��oi�Scheduler" class="headerlink" title="5. �߳̿��ƣ�Scheduler"></a>5. �߳̿��ƣ�Scheduler</h3><p>�������ı任��RxJava ��һ��ǿ��ĵط��������̵߳����ɿ��ơ�</p>
<h4 id="5-1-Scheduler��API"><a href="#5-1-Scheduler��API" class="headerlink" title="5.1 Scheduler��API"></a>5.1 Scheduler��API</h4><p>ǰ�潲���ˣ��������� subscribeOn() ��� observeOn() ��ʵ���߳̿��ƣ����¼��Ĳ��������ѷ����ڲ�ͬ���̡߳��������˽��� map() flatMap() �ȱ任��������Щ���µģ���ʵ���ǵ����սӴ� RxJava ʱ���ң������ˣ��ܲ��ܶ��л������̣߳�</p>
<p>���ǣ��ܡ���Ϊ observeOn() ָ������ Subscriber ���̣߳������ Subscriber �����ǣ��ϸ�˵Ӧ��Ϊ����һ���ǡ��������ﲻ�����Ϊ�����ǡ���subscribe() �����е� Subscriber ������ observeOn() ִ��ʱ�ĵ�ǰ Observable ����Ӧ�� Subscriber ��������ֱ���¼� Subscriber �����仰˵��observeOn() ָ��������֮��Ĳ������ڵ��̡߳��������ж���л��̵߳�����ֻҪ��ÿ����Ҫ�л��̵߳�λ�õ���һ�� observeOn() ���ɡ�</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>) <span class="comment">// IO �̣߳��� subscribeOn() ָ��</span></span><br><span class="line">    .subscribeOn(Schedulers.io())</span><br><span class="line">    .observeOn(Schedulers.newThread())</span><br><span class="line">    .map(mapOperator) <span class="comment">// ���̣߳��� observeOn() ָ��</span></span><br><span class="line">    .observeOn(Schedulers.io())</span><br><span class="line">    .map(mapOperator2) <span class="comment">// IO �̣߳��� observeOn() ָ��</span></span><br><span class="line">    .observeOn(AndroidSchedulers.mainThread) </span><br><span class="line">    .subscribe(subscriber);  <span class="comment">// Android ���̣߳��� observeOn() ָ��</span></span><br></pre></td></tr></table></figure>
<p>���ϣ�ͨ�� observeOn() �Ķ�ε��ã�����ʵ�����̵߳Ķ���л���</p>
<h4 id="5-2-Scheduler��ԭ��"><a href="#5-2-Scheduler��ԭ��" class="headerlink" title="5.2 Scheduler��ԭ��"></a>5.2 Scheduler��ԭ��</h4><p>��ʵ�� subscribeOn() �� observeOn() ���ڲ�ʵ�֣�Ҳ���õ� lift()�����忴ͼ����ͬ��ɫ�ļ�ͷ��ʾ��ͬ���̣߳���</p>
<p>subscribeOn() ԭ��ͼ��</p>
<p><img src="E:\���Ͽ�\��������\��ʼ�¼\�ӻ���\subscribe-on.jpg" alt="subscribe-on"></p>
<p>observeOn() ԭ��ͼ��</p>
<p><img src="E:\���Ͽ�\��������\��ʼ�¼\�ӻ���\observe-on.jpg" alt="observe-on"></p>
<p>��ͼ�п��Կ�����subscribeOn() �� observeOn() �������߳��л��Ĺ�����ͼ�е� “schedule…” ��λ������ͬ���ǣ� subscribeOn() ���߳��л������� OnSubscribe �У�������֪ͨ��һ�� OnSubscribe ʱ����ʱ�¼���û�п�ʼ���ͣ���� subscribeOn() ���߳̿��ƿ��Դ��¼������Ŀ��˾����Ӱ�죻�� observeOn() ���߳��л����������ڽ��� Subscriber �У�������������������һ�� Subscriber �����¼�ʱ����� observeOn() ���Ƶ�����������̡߳�</p>
<p>�������һ��ͼ�����͵���� subscribeOn() �� observeOn() ���ʹ��ʱ���̵߳�������ô�����ģ�����ͼ�ж���϶࣬����������ͼ�Խṹ����һЩ�򻯵�������</p>
<p><img src="E:\���Ͽ�\��������\��ʼ�¼\�ӻ���\complex-scheduler.jpg" alt="complex-scheduler"></p>
<p>ͼ�й��� 5 �����ж��¼��Ĳ�������ͼ�п��Կ������ٺ͢������ܵ�һ�� subscribeOn() Ӱ�죬�����ں�ɫ�̣߳��ۺܴ͢��ܵ�һ�� observeOn() ��Ӱ�죬��������ɫ�̣߳��ݴ��ܵڶ��� onserveOn() Ӱ�죬��������ɫ�̣߳����ڶ��� subscribeOn() ��������֪ͨ�������߳̾ͱ���һ�� subscribeOn() �ضϣ���˶��������̲�û���κ�Ӱ�졣����Ҳ�ͻش���ǰ������⣺��ʹ���˶�� subscribeOn() ��ʱ��ֻ�е�һ�� subscribeOn() �����á�</p>
<h4 id="5-3-���죺doOnSubscribe"><a href="#5-3-���죺doOnSubscribe" class="headerlink" title="5.3 ���죺doOnSubscribe()"></a>5.3 ���죺doOnSubscribe()</h4><p>Ȼ������Ȼ����һ���� subscribeOn() ���¼����������û��Ӱ�죬��������֮ǰȴ�ǿ������õġ�</p>
<p>��ǰ�潲 Subscriber ��ʱ���ᵽ�� Subscriber �� onStart() �����������̿�ʼǰ�ĳ�ʼ����Ȼ�� onStart() ������ subscribe() ����ʱ�ͱ������ˣ���˲���ָ���̣߳�����ֻ��ִ���� subscribe() ������ʱ���̡߳���͵������ onStart() �к��ж��߳���Ҫ��Ĵ��루�����ڽ�������ʾһ�� ProgressBar������������߳�ִ�У����������̷߳Ƿ��ķ��գ���Ϊ��ʱ���޷�Ԥ�� subscribe() ������ʲô�߳�ִ�С�</p>
<p>���� Subscriber.onStart() ���Ӧ�ģ���һ������ Observable.doOnSubscribe() ������ Subscriber.onStart() ͬ������ subscribe() ���ú�������¼�����ǰִ�У�����������������ָ���̡߳�Ĭ������£� doOnSubscribe() ִ���� subscribe() �������̣߳�������� doOnSubscribe() ֮���� subscribeOn() �Ļ�������ִ������������� subscribeOn() ��ָ�����̡߳�</p>
<p>ʾ�����룺</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Observable.create(onSubscribe)</span><br><span class="line">    .subscribeOn(Schedulers.io())</span><br><span class="line">    .doOnSubscribe(<span class="keyword">new</span> Action0() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">call</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            progressBar.setVisibility(View.VISIBLE); <span class="comment">// ��Ҫ�����߳�ִ��</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .subscribeOn(AndroidSchedulers.mainThread()) <span class="comment">// ָ�����߳�</span></span><br><span class="line">    .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">    .subscribe(subscriber);</span><br></pre></td></tr></table></figure>
<p>���ϣ��� doOnSubscribe()�ĺ����һ�� subscribeOn() ������ָ��׼���������߳��ˡ�</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2018/08/24/RxJava入门介绍/" data-title="Michael的博客" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2018/08/24/软件开发阅读书目/" title="">
  <strong>上一篇：</strong><br/>
  <span>
  (no title)</span>
</a>
</div>


<div class="next">
<a href="/2018/08/24/hexo搭建个人静态博客网站/"  title="">
 <strong>下一篇：</strong><br/> 
 <span>(no title)
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RxJava���Z���"><span class="toc-number">1.</span> <span class="toc-text">RxJava���Ž���</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#���"><span class="toc-number">1.1.</span> <span class="toc-text">���</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API-���ܺ�ԭ�����"><span class="toc-number">1.2.</span> <span class="toc-text">API ���ܺ�ԭ�����</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-�����չ�L۲���gʽ"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.  �����չ�Ĺ۲���ģʽ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-����ʵ��"><span class="toc-number">1.2.2.</span> <span class="toc-text">2. ����ʵ��</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-����-Observer"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">2.1 ���� Observer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-����-Observable"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">2.2 ���� Observable</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-Subscribe-����"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">2.3 Subscribe (����)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-ʹ��ʾ��"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">2.4 ʹ��ʾ��</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-�߳̿���-Scheduler"><span class="toc-number">1.2.3.</span> <span class="toc-text">3. �߳̿���(Scheduler)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-Scheduler-��-API"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">3.1 Scheduler �� API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-Scheduler��ԭ��"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">3.2 Scheduler��ԭ��</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-�任"><span class="toc-number">1.2.4.</span> <span class="toc-text">4.�任</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-API"><span class="toc-number">1.2.4.1.</span> <span class="toc-text">4.1 API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-�任��ԭ��-lift"><span class="toc-number">1.2.4.2.</span> <span class="toc-text">4.2 �任��ԭ��(lift)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-compose-��-Observable-����i任"><span class="toc-number">1.2.4.3.</span> <span class="toc-text">4.3 compose: �� Observable ����ı任</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-�߳̿��oi�Scheduler"><span class="toc-number">1.2.5.</span> <span class="toc-text">5. �߳̿��ƣ�Scheduler</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-Scheduler��API"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">5.1 Scheduler��API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-Scheduler��ԭ��"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">5.2 Scheduler��ԭ��</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-���죺doOnSubscribe"><span class="toc-number">1.2.5.3.</span> <span class="toc-text">5.3 ���죺doOnSubscribe()</span></a></li></ol></li></ol></li></ol></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  

  

  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://github.com/baoxielin/" target="_blank" title="我的GitHub主页">Github</a>
            
          </li>
        
          <li>
            
            	<a href="https://toutiao.io/" target="_blank" title="程序员首选阅读分享平台">开发者头条</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.jobbole.com/" target="_blank" title="专注于分享IT互联网相关的文章">伯乐在线</a>
            
          </li>
        
          <li>
            
            	<a href="https://juejin.im/" target="_blank" title="高质量的技术社区">稀土掘金</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.android-studio.org/" target="_blank" title="AndroidStudio中文社区">AndroidStudio中文社区</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.oschina.net/" target="_blank" title="开源中国社区">开源中国社区</a>
            
          </li>
        
          <li>
            
            	<a href="https://martinfowler.com/" target="_blank" title="MartinFlower">MartinFlower</a>
            
          </li>
        
          <li>
            
            	<a href="https://coolshell.cn/" target="_blank" title="酷壳">酷壳</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.luanxiang.org/" target="_blank" title="乱象，印迹">乱象，印迹</a>
            
          </li>
        
          <li>
            
            	<a href="https://blog.csdn.net/guolin_blog/" target="_blank" title="郭霖专栏">郭霖专栏</a>
            
          </li>
        
          <li>
            
            	<a href="https://blog.csdn.net/xlgen157387" target="_blank" title="徐刘根的博客">徐刘根的博客</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.liaoxuefeng.com/" target="_blank" title="廖雪峰的官方网站">廖雪峰的官方网站</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.buzzfeed.com/" target="_blank" title="BuzzFeeD">BuzzFeeD</a>
            
          </li>
        
    </ul>
</div>

  


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 交流促进思考，沟通产生价值 <br/>
			落霞与孤鹜起飞，秋水共长天一色</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/https://github.com/baoxielin/" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:baoxielin@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="Michael">Michael</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
